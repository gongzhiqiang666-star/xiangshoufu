整体操作流程：
        开代理-设置政策（结算价） - 下发机具 - 装机（流量卡-押金-费率） - 产生交易- 分润、押金奖励、流量费奖励、活动奖励等


分润逻辑
    → 支持多种分润模式，核心规则是第一级代理会给一个利率，例如万分之51，一级代理要发展他的子代理或者代理团队，会给他的子
    代理万分之55，以此类推，整个机构类似于一个多叉树结构，大家都在上一级的基础上增加利率，上限是最终给到商户的利润，例如
    是万分之60。代理商可以自己开发商户，也可以继续发展子代理团队，代理商开发商户后，会给商户一个POS机，这里叫机具，机具和
    商户绑定，商户通过机具消费后，产生流水，流水会通过WEBAPI推送回我们数据库中，我们通过对流水的实时计算，算出该消费机具
    对应代理商该得的分润，以及他的上一级代理商该得的分润，上上级代理商该得的分润，直至没有利润，理解商就是从当前代理商这
    一级一直往上溯源，将这一条树叶一直追溯到主干，每一级别该得的分润计算出来，显示到APP上。
    ● 分润的结算周期是怎样的？
    → 交易完成后，收到POS机厂商传过来的交易流水，立即计算出各个代理商该得的分润，这部分钱先到钱包里，有个功能叫钱包，钱包
    里的钱要够一定的金额才能提现。
    ● 分润最多向上追溯几级代理？
    → 不限层级，直至没有利润为止
    ● 系统需要支持哪些用户角色？
    → 平台管理员, 代理商, 财务人员

    所有分润都不考虑退费部分，退费部分如果有单独计算分润。

通道概念
    我们作为第四方支付公司， 需要对接第三方支付公司，例如拉卡拉公司，机具和交易流水、消息通知、商户维护等都需要和这种第三方公司做接口。
    我们预计会对接8家支付公司，也叫通道或者支付通道，APP很多功能也要基于通道去做维护。


返现概念
    达到一定条件返回给直属代理商固定金额的钱，例如流量费分首次、二次、二加N次约定返现金额，押金约定返现金额等。
分润概念
    是要按照代理的层及结构、利差计算各级代理商该得的利润。

政策模板概念
    指的分润、奖励、押金、服务费的计算规则，每个代理商注册后都有一个默认政策模板。

结算价概念
    内容和政策模板相同，但可以基于政策模板的内容进行调整，确定该代理商的最终结算价。


代理拓展
    作为APP端的独立模块，主要用来拓展服务商使用，包括主动注册和被动注册
        主动注册就是使用拓展码（二维码）展示、可保存相册、可复制链接给下级代理商，推介码用手机号？ 
        被动注册就是手动填写下级代理商信息验证通过后成为代理商，下级代理商根据二维码下载应用后登录使用。
    
    注册后使用默认政策模板，具体参考政策模板
    机构树说明：
        总部
        机构（字母加手机号）一级代理商叫
        他的下面叫直属代理商（B端）、直营客户（C端）
        再往下下级代理商

    背景说明：这块操作会产生代理商的上下级关系，后期分润就是按这个关系进行分润的，当然上级代理商的政策模版自动带入下级代理商中，或者叫继承政策模版，当然上下级的费率是不同的，这个在代理管理中有体现。

营销海报
    营销海报作为APP的独立模块，主要是用来发微信朋友圈、发抖音使用；数据由后台导入，导入后APP端可以保存到本地，以供发朋友圈使用。
    可以增加分类，不同分类下维护不同的海报信息，APP和这个海报信息同步
    要注意控制大小，否则影响服务器。

滚动图
    滚动图用来在APP端首页做宣传使用，也是有后端维护。


代理管理	
    1.政策模版设置
    规则1:分润设置，通道方会给我们贷记卡的结算、借记卡（包括封顶结算）的结算、银联云闪付结算、微信扫码结算、支付宝扫码结算、客户秒到费率的加1、加2、加3（这块不太懂，遗留问题）

    规则2：返现设置，机具49一台，30天有效期内客户有10000流水，奖励你50块钱
    规则3: 返现设置，流量卡79、商户扣取流量卡成功（通过交易数据返回），返代理商69，我自己留10块。设置上分首次、2次、2+N次返给代理商多少钱，数字。 不同通道不同配置。

    这个政策模版按照通道，每个通道都有一个默认模板，多个模板可以使用。
    代理商可以用那些通道也在这里设置，APP端只显示已开通的通道。
    模板里设置的是结算价的逻辑，

    
    结算价：指的是代理商开拓商户，利率是分阶段调整的，例如第一阶段（例如180天内，这个可调整）费率是515，第二阶段（180天后）费率是55 ，这个和商户说好。
    通道到时候传回来商户的交易流水的利率是60，我们计算结算价时就会分阶段计算分润以及其上级的级差，来确定整个整个消费树下所有相关人的分润湿多少。
    具体这个时间阶段是按商户入网时间还是什么时间这个在政策模板中维护。
    费率的范围是每个通道给过来的，我们可以在这个范围内调整，这个调整在商户管理下。
    代理商是有权限更改对应商户费率的。

    分润的逻辑上面讲了，这里举个例子：例如我们给代理商的利率是51，最终代理商拓展出的商户给到的是60，那代理商每消费10000块，代理商就会有9个点的利润，也就是9块的利润；而他的上级利率是49，那他的上级也能拿2块，如果上级还有上级，并且有级差和利差，那还要继续分润，直至没有利润。
    换个角度：每个级别的代理商都有一个固定利率，这个利率是在政策模板中维护好的，每增加一级代理商，利率会递增，这叫利差，大家都有钱赚才是王道。
    最终的分润也是按照约定的利差拿到自己应该获得的利润，当然子代理也可以和上级利率一样，那后期这部分利润是要给到下级代理商的，上级是没有分润的，钱留在了离客户最近的一级（取下原则）。

    
    结算价分几个板块，一个是分润、一个是返现，返现是我们给代理商设置的奖励，通道返回的交易数据里会体现： 服务费刷卡、流量费刷卡、普通交易。
    普通交易涉及分润
    服务费刷卡涉及返现 
    押金收取成功涉及返现


    所以一笔交易过来，要分4部分计算，每个代理商对应每个通道的政策模板都分这四部分：
        1.分润	和各通道联动做结算，参考结算价
        2.奖励	例如30天1万，奖励多少。这个也要分阶段设置，例如0到30天奖励多少，30到60天奖励多少。这个也是政策模板。并且有生效时间。
            这个奖励的政策模板里要有这个设置，可以分多个阶段奖励，同时有生效时间，例如以注册为维度，某个时间后注册的商户按新的奖励走。
        3.押金	涉及返现， 通道告诉我们手机299，我们设置部分返现给代理商：0到299 的一个范围，具体多少要按照通道的要求走，每个通道不一样。
        4.流量费 涉及返现  具体多少要按照通道的要求走，每个通道不一样。

    返现政策举例：
        机具49一台，30天有效期内客户有10000流水，奖励你50块钱；
        流量卡79、商户扣取流量卡成功（通过交易数据返回），返代理商69，我自己留10块。


    商户端通道会给到十足的权限，我们可以在上面的政策模板里设置不收押金，收99，收199，我们设置好后直接推给商户，商户交易时实时结算。
    机具切换时，流量卡和押金必须设置好，通过通道提供的接口推送到机具上，或者直接使用政策模板，下发默认的政策。
    费率可以实时修改，调用通道接口，实时生效，可以随时调整（个别通道不开放、结合接口文档）。


    


    所有分润暂时不考虑退费部分，退费部分如果有单独计算分润。

    还要考虑手动调账功能，后台管理功能，可以自定义对代理商的分润进行调整。

整体：我们给代理商制定游戏规则，规则是根据通道方给我们推回来的数据，我们根据交易流水、根据我们和代理商制定的政策（涉及结算价、返现、分润、奖金），给代理商付钱。

代理商有哪些属性，要自己注册下明确？ 包括：个人基本信息 身份证号、手机号、开户行、注册时间，给到的政策。


1.服务商成本设置：
    包括贷记卡、借记卡、借记卡封顶、银联（云闪付）扫码、微信费率、支付宝费率等的设置，这块要和通道交互，建议也按通道维护，或者提取出共性的属性，一次维护，这块具体需要看接口文档。

2.服务商调价配置：
分两种情况：
    ①以商户入网时间为条件：入网0-180天，费率涨多少；入网181-360天，费率涨多少；入网361-540天，费率涨多大；入网541天以上，费率涨多少                                                                                      ②以代理商开后台时间为条件：代理商入网0-360天，结算价多少；代理商入网361-540天，结算价多少；代理商入网541天以上，结算价多少(天数自定义)

3.服务商偷数据权限（是否下放权限）：根据金额区间、根据时间段生效，这块是后台功能？
4.显示代理设备数量（已激活，未激活），代理注册时间，
5.支付通道可隐藏

终端管理	
操作 机具下发、机具回拨、机具政策设置、操作记录（显示通道、押金、状态）

机具下发 - 领走机具（绑定代理商），到时候绑定商户、设置费率、押金奖励、流量费奖励等，必须一级一级下发。
机具回拨（未激活的才能回拨） - 退货，谁领的退给谁，不可跨级，也是一级一级回收

机具下发绑定代代理商，代理商最终绑定商户，此时代理商在我们系统叫直营，往上推就是上级。
APP 不能跨级回拨，PC后台可以跨级下发和回拨操作，不能跨级回拨是因为机具是代理商领走的，代理商还要给下级，这里面设置利润、关系、人情，不能轻易跨级回拨。


1.APP显示 终端总数、已激活台数、未激活台数、昨日激活数、今日激活数、本月激活数：库存里显示终端号，区分：未绑定、已绑定、未激活、已激活
2.终端划拨（不可跨级）、终端回拨（不可跨级）、划拨记录、回拨记录查看

3.批量设置费率:0.53%，0.54%，0.55%，0.56%，0.57%，0.58%，0.59%，0.6%
4.批量设置SIM卡（根据接口）:首次扣费金额：48，60,69,79,89，99
                非首次扣费金额：48，60,69,79,89，99
                非首次间隔天数：180，210,240,270,300,330,360
5.批量设置押金：无押金，99押金，199押金，299押金

货款代扣：
    货款代扣作为APP的独立模块展现 
    划拨终端时，可给下级设置货款代扣，需要下级接收一下。 
    考虑到是终端划拨时用此交易，那在APP端需要绑定该代理商，已被后续自动从其钱包自动扣款
    举例:
        一台pos机货款50元，
        代理A从公司拿了100台
        货款50*100=5000元
        代理A没有给公司货款
        公司可以给代理设置5000元的货款代扣（设置时，可以选择从分润钱包扣，还是从返现钱包扣，还是两个钱包都扣）
        代理A接收后
        选择的钱包有了钱就会被扣走，直到扣够5000元停止
    
    说明：代理A的下级B从他那里拿货，代理A也可以给代理B设置代扣货款，每级都有这个权限



商户管理

    参考恒信通
    按通道筛选，显筛选显示			
    支持押金设定、增加费率修改、流量卡设定

客户登记	
        就是商户登记
        作为APP和PC端的独立功能		
       
        备注说明：
        支付版块基本分为两类产品，一类是小微，是不需要进件的，另一类是真商是需要进件的，可以接，目前重心先都放到小微，打通后再接真商，此功能预留。
        商户登记的目的是因为支付公司给我们回传商户信息的时候，是没有商户的完整的手机号得。
        我们用这个功能主要登记商户的手机号。推过来的进行匹配，目的是为了方便之后联系那个咱们的那个直属的代理商，再去联系这个商户，是为了方便这个，然后在这个功能上我们可以在数据分析的时候，帮助代理行商分析一些流失的商户，让他有联系的方式，主要是达到这个目的。
        所以这个功能就是将通道推回来的商户信息中的手机号二次维护，当然数据库里要加密存储，而且只有对应代理商才能看到。
        当然后续我们也要做真商，做真商时该功能肯定就实时维护商户信息了，然后将信息给到通道方，目前此功能不做，能够维护商户的一些信息和备注信息即可。

    
    商户管理和客户登记都要增加商户类型，包括
        APP和PC端显示商户类型，计算方法：忠诚商户（月均大于5万），优质商户（月均大于等于3万小于5万），潜力商户（月均大于等于两万小于3万），一般商户（月均大于等于一万小于两万），低活跃商户（月均大于0小于1万），30天无交易。
    这部分一天计算一次就好

    商户端通道会给到十足的权限，我们可以在上面的政策模板里设置不收押金，收99，收199，我们设置好后直接推给商户，商户交易时实时结算。
    机具切换时：流量卡和押金必须设置好，通过通道提供的接口推送到机具上，或者直接使用政策模板，下发默认的政策。
    费率可以实时修改，调用通道接口，实时生效，可以随时调整（个别通道不开放、结合接口文档）。
    
    这部分涉及和机具通信，下发政策。

    分直营商户和团队商户：商户姓名、商户编号、费率变更、交易查询（显示各月交易量）、商户手机号（加*号）， 是否活跃、是否直属这两属性待定）
    详情（根据接口）：脱敏手机号、机具编号、激活时间、首次流量费时间、首次流量费金额、刷卡费率、扫码费率、交易额统计（累计、本月总额、本月贷记卡、本月借记卡、本月微信、本月支付宝）
    要求：商户姓名、商户编号、机具编号可以互查
    注意：商户信息除了姓名，其他涉及个人信息部分全部脱敏存储，如果是代理商新增商户，那该手机号只向该代理商展示。


数据分析	
    （确认口径）交易查询：全部、直营、团队（代理商）三部分，最近6个月数据，参考恒信通功能要核对。
    
    （确认口径）商户交易量分析：忠诚商户（月均大于5万），优质商户（月均大于等于3万小于5万），潜力商户（月均大于等于两万小
    于3万），一般商户（月均大于等于一万小于两万），低活跃商户（月均大于0小于1万），30天无交易
    关于APP数据展示部分，目前只能显示自己和子代理汇总的数据，子代理再往下的数据APP端代理商自己看不到，可以到后台查看，APP不做深入展示。


    代理数据分析：各代理交易量排名、各代理交易笔数排名、各代理终端总数、各代理已激活终端数
    客户数据分析（直营、下级）：客户总交易量：刷卡占比、支付宝占比、微信占比
    直营商户：（按本月交易排名）姓名、脱敏手机号、累积交易、本月交易；点进去，显示机具号，刷卡交易金额，扫码交易金额，近七天交易金额，近半年交易金额
  
    
    后续完善，王康康提供。
    

收益统计	
    今日收益总额，今日收益明细（交易收益，押金返现，流量返现）；收益趋势：近7天，近30天；查看月收益：近六个月，近一年，近两年
    后续完善，王康康提供。

代扣管理
    分上级扣款 上级扣款需要发起，然后上级同意。
    伙伴代扣也要伙伴同意。
    代扣包括4个属性：代扣伙伴、代扣金额、代扣期数和代扣来源（分润钱包、服务费钱包等扣除）、代扣协议（涉及法律文书）。


钱包	
    1.正常钱包
    钱包按分润、服务费（流量费+机具押金）、奖励 以及提现通道分类，显示钱包金额，并且每个钱包都有提现门槛，达到提现门槛就能提现
    钱包提现是通过税筹通道兑付的，我们在税筹通道有账户，通过这个账户赚钱给代理商，同时扣除对应的费用（税+单笔固定金额费用），例如9%+3 每笔。

    税筹通道需要对接对应厂商，参考对应接口文档。
    这个钱包的数字是代理商该得的利润，但钱是在通道厂商那边，我们可以选择通过公户领回，也可以直接接通代付通道，支付给代理商。
    
    税筹上我们会保留一定的利润，例如9%的手续费 + 3元/笔，扣除这个钱后就是代理商实际该得的费用，这个要算好后，通过代付公司给代理商付款。
    通道不一样，扣法不一样，分付款扣和出款扣，根据不同通道算出给代理商多少钱，但最终给代理商的钱不会变。

    提现门槛：不同通道 - 不同钱包（分润钱包、服务费钱包（流量+押金）、奖励钱包），提现门槛不同，要设置。

    2.充值钱包：和奖励钱包挂钩的，自己存钱给下级代理商，是代理商额外给下级代理商的钱。给多少钱看奖励条件（奖励政策模板设置里操作）  
        充值钱包也可以提供贷款，收一份利息，走线下协议。

    3.沉淀钱包：可以提现下级未提现钱包的钱，允许使用一定比例，例如30%。相当于用了下级代理商的钱，但下级不知道，而且下级超出部分无法提现。
        正常如果下级代理商提现失败，那该代理商应该将沉淀钱包里的钱充回。如果出现无法充回的情况，我们可以帮助该代理商预付，但需要收取利息（相当于贷款，走自有资金，线下签协议），是未来的一个盈利的点。
    
    充值钱包和沉淀钱包如果发生借贷，也叫前置分润，我们要收取一定的费用，后续还款暂时走线下。
    充值钱包和沉淀钱包要求可隐藏、可设置比例。

我的信息	
    姓名，手机号，服务商编号，入网时间，脱敏身份证号，结算卡，更改结算卡按钮，费率成本，代理有唯一邀请码，代理邀请码可自定义靓号

消息通知
    APP端提醒  用来提醒分润、注册、消费的消息提醒，这些叫业务提醒，还有例如节假日提醒都要通过APP能够及时的提醒出去，点进来是对应的消息管理界面，可以看历史消息。
    消息有效期3天，3天内未查看一直活跃，直到过期。

    PC端登录后要弹窗，提醒最近更新重要内容。


本程序对金额的计算要严谨，尤其是基于成功交易流水，各级代理商的分润、押金、流量费返现的计算、货款代扣、代扣管理（上级和伙伴）、沉淀钱包、充值钱包变动，或者说所有钱包的变动必须要前后一致，有具可查，金额不能凭空产生，都需要基于业务数据来源，都需要有记录表记录，而且最后的测试用例也要完整，考虑到刚刚说的这些场景，必须做自动测试，验证涉及金额的准确性、流程都要测试到位，应该产生什么数据，实际产生什么数据都要做自动测试，每次打包都要测试通过才能发布。

帮我整理出APP核心功能

